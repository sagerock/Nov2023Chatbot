<style>
  body {
    font-family: 'Arial', sans-serif;
    background-color: #f5f5f5;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  #chat-container {
    max-width: 500px;
    width: 100%;
    background: white;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-radius: 5px;
    overflow: hidden;
  }

  #conversation {
    height: 400px;
    overflow-y: auto;
    padding: 10px;
    background: #e7e7e7;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .message {
    padding: 5px 10px;
    border-radius: 5px;
    max-width: 80%;
  }

  .user-message {
    background: #0f62fe;
    color: white;
    align-self: flex-end;
  }

  .bot-message {
    background: #eeeeee;
    color: black;
    align-self: flex-start;
  }

  #message-input {
    width: calc(100% - 20px);
    padding: 10px;
    margin: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    box-sizing: border-box;
  }

  #send-button {
    width: calc(100% - 20px);
    padding: 10px;
    margin: 10px;
    background: #0f62fe;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  #send-button:hover {
    background: #0053e7;
  }


   /* Spinner Styles */
 .spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border-left-color: #0f62fe;
    margin: 10px auto;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  /* Hide the spinner by default */
  .hidden {
    display: none;
  }
  /* Responsive Styles */
  @media (max-width: 600px) {
    body {
      justify-content: flex-start;
      height: auto;
      padding-top: 50px;
    }
    #chat-container {
      margin: 0 10px;
      box-shadow: none;
    }
    .message {
      padding: 5px;
      font-size: 0.9rem;
    }
    #message-input, #send-button {
      margin: 5px;
      padding: 8px;
    }
  }


</style>


</head>
<body>
  <div id="chat-container">
    <div id="specialization-container">
      <h2>Pick a Specialization:</h2>
      <select id="prompt-select">
        <option value="general">General Knowledge</option>    
        <option value="therapist">Therapist</option>
        <option value="travel_guide">Travel Guide</option>
        <option value="web_dev">Web Developer</option>
        <option value="motivation">Motivation Coach</option>
        <option value="plagiarism">Plagiarism Checker</option>
        <option value="essay">Essay Writer</option>
        <option value="python_expert">Python Expert</option>
        <option value="philosophy">Philosophy Teacher</option>
        <option value="astrologer">Astrologer</option>
        <option value="film_critic">Film Critic</option>
        <option value="snark">Snark</option>
        <option value="prompt_generator">ChatGPT prompt generator</option>
      </select>
    </div>
  <div id="conversation"></div>
  <div class="spinner hidden" id="spinner"></div>
  <textarea id="message-input" placeholder="Type a message..." rows="4"></textarea> <!-- Adjust the 'rows' as needed -->
  <button id="send-button">Send</button>
</div>

<script>
  // A simple markdown to HTML conversion function (for bold and new lines only)
function convertMarkdownToHTML(text) {
  return text
    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Convert bold
    .replace(/\n/g, '<br>'); // Convert new lines to breaks
}
document.getElementById('send-button').onclick = function() {
  // Show the spinner
  showSpinner();

  var message = document.getElementById('message-input').value;
  var promptId = document.getElementById('prompt-select').value; // Get the selected prompt ID
  
  fetch('http://127.0.0.1:5000/send_message', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      prompt_id: promptId, // Use the selected prompt ID
      message: message
    }),
  })
  .then(response => response.json())
  .then(data => {
    // Hide the spinner when the response is received
    hideSpinner();

    // Display the response from the chatbot
    var conversation = document.getElementById('conversation');
    conversation.innerHTML += `<div class="message user-message">${message}</div>`;
  
    var botMessage = document.createElement('div');
    botMessage.classList.add('message', 'bot-message');
  
    // Assuming your API returns markdown, convert it to HTML
    var formattedResponse = convertMarkdownToHTML(data.choices[0].message.content);

    // Create a copy button
    var copyBtn = document.createElement('button');
    copyBtn.innerText = 'Copy';
    copyBtn.onclick = function() {
      // Copy the bot's message to the clipboard
      navigator.clipboard.writeText(data.choices[0].message.content)
        .then(() => {
          // Notify the user that the text has been copied
          alert('Text copied to clipboard');
        })
        .catch(err => {
          console.error('Error copying text: ', err);
        });
    };

    // Append the formatted response and the copy button to the bot message
    botMessage.innerHTML = formattedResponse;
    botMessage.appendChild(copyBtn);

    conversation.appendChild(botMessage);

    // Scroll to the latest message
    conversation.scrollTop = conversation.scrollHeight;
  })
  .catch((error) => {
    // Hide the spinner in case of error as well
    hideSpinner();
    console.error('Error:', error);
  });

  // Clear the input field
  document.getElementById('message-input').value = '';
};

// Function to show the spinner
function showSpinner() {
  document.getElementById('spinner').classList.remove('hidden');
}

// Function to hide the spinner
function hideSpinner() {
  document.getElementById('spinner').classList.add('hidden');
}
</script>
</body>
</html>
